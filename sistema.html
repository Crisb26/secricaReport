<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema - SECRICA REPORT</title>
    <link rel="stylesheet" href="styles/style.css">
    <link rel="stylesheet" href="styles/sistema.css">
</head>
<body>
    <div class="sistema-container">
        <!-- Header -->
        <header class="sistema-header">
            <div class="header-content">
                <div class="logo-sistema">
                    <img src="assets/images/logo-defensa-civil.png.png" alt="Defensa Civil" class="logo-img" width="">
                    <div class="logo-text">
                        <h1 style="font-size: 30px;">SECRICA REPORT</h1>
                        <p style="font-size: 20px;">Sistema de Reportes - Defensa Civil Quind√≠o</p>
                    </div>
                </div>
                <div class="user-info">
                    <span id="usuarioActual">Cargando...</span>
                    <button onclick="cerrarSesion()" class="btn btn-logout">Cerrar Sesi√≥n</button>
                </div>
            </div>
        </header>

        <!-- Navegaci√≥n -->
        <nav class="sistema-nav">
            <div class="nav-content">
                <button class="nav-btn active" data-section="dashboard">üìä Dashboard</button>
                <button class="nav-btn" data-section="reportes">üìù Reportes</button>
                <button class="nav-btn" data-section="clima">üå§Ô∏è Clima IA</button>
                <button class="nav-btn" data-section="seguimiento">üìà Seguimiento IA</button>
                <button class="nav-btn" data-section="usuarios">üë• Usuarios</button>
            </div>
        </nav>

        <!-- Contenido Principal -->
        <main class="sistema-main">
            <!-- Dashboard -->
            <section id="dashboard" style="padding: 80px;" class="seccion active">
                <h2>Dashboard Principal</h2>
                <div class="dashboard-grid" style="margin-top: 100px;">
                    <div class="dashboard-card" style="padding: 20px; font-size: 20px">
                        <h3>Reportes Hoy</h3>
                        <div class="card-number" id="reportesHoy">0</div>
                        <p>Reportes registrados hoy</p>
                    </div>
                    <div class="dashboard-card" style="padding: 20px; font-size: 20px">
                        <h3>Usuarios Activos</h3>
                        <div class="card-number" id="usuariosActivos">0</div>
                        <p>Usuarios en el sistema</p>
                    </div>
                    <div class="dashboard-card" style="padding: 20px; font-size: 20px">
                        <h3>Emergencias</h3>
                        <div class="card-number alertas" style="font-size: 30px;" id="emergenciasAbiertas">0</div>
                        <p>Casos abiertos</p>
                    </div>
                    <div class="dashboard-card" style="padding: 20px; font-size: 20px;">
                        <h3>Clima Actual</h3>
                        <div class="card-weather" style="padding: 20px; font-size: 25px;" id="climaActual">Cargando...</div>
                        <p id="ubicacionClima">Armenia, Quind√≠o</p>
                    </div>
                </div>
            </section>

            <!-- Reportes -->
            <section id="reportes" class="seccion">
            <h2>Gesti√≥n de Reportes</h2>
            <div class="reportes-container">
                <div class="reportes-lista" id="listaReportes"></div>  <!-- los reportes se cargarian dinamicamente aqui -->
            </div>
        </section>

            <!-- Clima IA -->
            <section id="clima" class="seccion">
                <h2>Sistema de Clima con IA</h2>
                <div class="clima-container">
                    <div class="clima-actual">
                        <h3>Clima Actual - Armenia, Quind√≠o</h3>
                        <div id="climaDetallado">Cargando datos meteorol√≥gicos...</div>
                    </div>
                    <div class="clima-prediccion">
                        <h3>Predicci√≥n IA - Pr√≥ximos 5 d√≠as</h3>
                        <div id="prediccionIA">Analizando patrones clim√°ticos...</div>
                    </div>
                </div>
            </section>

            <!-- Seguimiento IA -->
            <section id="seguimiento" class="seccion">
                <h2>Seguimiento Inteligente de Reportes</h2>
                <div class="seguimiento-container">
                    <div class="seguimiento-stats">
                        <h3>An√°lisis IA de Reportes</h3>
                        <div id="analisisIA">Analizando patrones de reportes...</div>
                    </div>
                    <div class="seguimiento-chart">
                        <h3>Tendencias Detectadas</h3>
                        <canvas id="chartTendencias"></canvas>
                    </div>
                </div>
            </section>

            <!-- Usuarios -->
            <section id="usuarios" class="seccion">
                <h2>Gesti√≥n de Usuarios</h2>
                <div class="usuarios-container">
                    <div class="usuarios-lista" id="listaUsuarios">
                        <!-- Usuarios se cargan din√°micamente -->
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal de cierre de sesi√≥n -->
    <div id="modalCerrarSesion" class="modal">
    <div class="modal-content">
        <h3>¬øEst√°s seguro que deseas cerrar sesi√≥n?</h3>
        <div class="modal-actions">
        <button id="btnConfirmarCerrar" class="btn btn-danger">Cerrar sesi√≥n</button>
        <button id="btnCancelarCerrar" class="btn btn-secondary">Cancelar</button>
        </div>
    </div>
    </div>

    <!-- Modal para Nuevo Reporte -->
    <div id="modalNuevoReporte" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Nuevo Reporte de Emergencia</h2>
                <button class="modal-close" onclick="cerrarModalNuevoReporte()">&times;</button>
            </div>
            <form id="formNuevoReporte" class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="fechaHoraReporte" class="form-label">Fecha y Hora</label>
                        <input type="datetime-local" id="fechaHoraReporte" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="tipoEmergencia" class="form-label">Tipo de Emergencia</label>
                        <select id="tipoEmergencia" class="form-control" required>
                            <option value="">Seleccionar tipo</option>
                            <option value="Incendio Forestal">üî• Incendio Forestal</option>
                            <option value="Incendio Estructural">üè† Incendio Estructural</option>
                            <option value="Deslizamiento">üèîÔ∏è Deslizamiento</option>
                            <option value="Inundaci√≥n">üåä Inundaci√≥n</option>
                            <option value="Rescate Animal">üêï Rescate Animal</option>
                            <option value="Rescate Persona">üë§ Rescate Persona</option>
                            <option value="Emergencia M√©dica">üöë Emergencia M√©dica</option>
                            <option value="Accidente de Tr√°nsito">üöó Accidente de Tr√°nsito</option>
                            <option value="√Årbol Ca√≠do">üå≥ √Årbol Ca√≠do</option>
                            <option value="Avalancha">‚õ∞Ô∏è Avalancha</option>
                            <option value="Derrame de Combustible">‚õΩ Derrame de Combustible</option>
                            <option value="Emergencia Tecnol√≥gica">üíª Emergencia Tecnol√≥gica</option>
                            <option value="Otra">‚ùì Otra... ¬øCu√°l?</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="municipioReporte" class="form-label">Municipio</label>
                        <select id="municipioReporte" class="form-control" required>
                            <option value="">Seleccionar municipio</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="prioridadReporte" class="form-label">Nivel de Prioridad</label>
                        <select id="prioridadReporte" class="form-control" required>
                            <option value="">Seleccionar prioridad</option>
                            <option value="ALTA">üö® ALTA - Riesgo inminente</option>
                            <option value="MEDIA">‚ö†Ô∏è MEDIA - Requiere atenci√≥n</option>
                            <option value="BAJA">‚ÑπÔ∏è BAJA - Sin riesgo inmediato</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Unidades Radiales Reportando</label>
                    <div id="unidadesRadialesContainer" class="checkbox-container"></div>
                </div>
                <div class="form-group">
                    <label for="responsableReporte" class="form-label">Responsable que Reporta</label>
                    <input type="text" id="responsableReporte" class="form-control" readonly placeholder="Se autocompletar√° seg√∫n unidades seleccionadas">
                </div>
                <div class="form-group">
                    <label for="descripcionReporte" class="form-label">Descripci√≥n de la Novedad</label>
                    <textarea id="descripcionReporte" class="form-control" rows="4" required placeholder="Describe detalladamente la situaci√≥n reportada..."></textarea>
                </div>
                <div class="form-group">
                    <label for="ubicacionReporte" class="form-label">Ubicaci√≥n Espec√≠fica</label>
                    <input type="text" id="ubicacionReporte" class="form-control" placeholder="Direcci√≥n, barrio, vereda o punto de referencia">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="cerrarModalNuevoReporte()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar Reporte</button>
                </div>
            </form>
        </div>
    </div>

    <!-- M√≥dulos que usan export/import -->
    <script type="module" src="scripts/crypto-utils.js"></script>
    <script src="scripts/sistema.js"></script> <!-- SIN type="module" -->
    <script type="module" src="scripts/seguimiento-ia.js"></script>
    <script type="module" src="scripts/clima-ia.js"></script>
    <script src="scripts/chatbot-ia.js"></script>
    <script src="scripts/utilidades.js"></script>
    
</body>
</html>